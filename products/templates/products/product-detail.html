{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'products/css/products.css' %}" type="text/css">
{% endblock %}

<!-- Free delivery banner -->
{% block extra_header %}
<div class="container-fluid">
<div class="row no-gutters text-center" id="free-delivery-banner">
    <div class="col-sm-12 my-1" id="free-delivery-banner">
        <h5 class="py-2 mb-0">Free delivery on orders over &euro;{{ free_delivery_threshold }}!</h5>
    </div>
</div>
<div class="hr-style"></div>
</div>
{% endblock %}

{% block content %}
<!-- Product detail -->
<div class="container mb-5 mt-3" id="product-detail-container">
    <div class="card" id="product-detail-card">
        <div class="row h-100">
            <div class="col-12 px-4">
                <!-- checks for the collection name in the database to include in the title-->
                <h4 class="my-4 ml-2 text-uppercase">collection: {{ product.collection_name.friendly_name}}</h4>
            </div>
            <div class="col-12 col-md-6 my-4 align-self-center">
                <!-- checks for images in the product images folder-->
                {% for img in product.images_folder.imgs.all %}
                <!-- if one of the images is set to be as main, it's then displayed-->
                {% if img.main_img %}
                <a href="{{ img.url }}" target="_blank">
                    <img class="card-img-top img-fluid" src="{{ img.url }}" alt="{{ img.name }}">
                </a>
                <!-- if no image available it displays default image -->
                {% else %}
                <a href="">
                    <img class="card-img-top img-fluid" src="{{ MEDIA_URL }}noimage.png" alt="no image">
                </a>
                {% endif %}
                {% endfor %}
            </div>
            <div class="col-12 col-md-6">
                <div class="container">
                    <div class="row align-items-start h-75">
                        <div class="col p-0 mt-sm-6" id="product-detail-content">
                            <!-- checks for assigned tag -->
                            <p class="artwork-tag tag-{{product.tag.friendly_name.lower}} my-4">
                                {{product.tag.friendly_name}}</p>
                            <!-- checks for product name and assigns -->
                            <h3 class="artwork-title">{{ product.name }}</h3>
                            <div class="hr-style"></div>
                            <!-- checks for product description-->
                            <p>{{ product.description }}</p>
                            <!-- product dimensions-->
                            <p class="pt-4">Dimensions: {{ product.dimensions }}</p>
                            <!-- if products is not sold then price is displayed-->
                            {% if not product.tag.name == 'sold' %}
                            <h5 class="pt-4">&euro; {{ product.price }}</h5>
                            {%endif%}
                            <div class="hr-style"></div>
                            <!-- room view button; triggers modal-->
                            <a class="px-3" href="" title="room view" aria-label="room view" id="room-view"
                                data-toggle="modal" data-target="#roomViewModal">
                                <p><i class="fas fa-eye"></i>room view</p>
                            </a>
                            <!-- room view modal -->
                            {% include 'products/includes/room-view-modal.html' %}
                        </div>
                    </div>
                    <div class="row align-items-end">
                        <div class="col p-0">
                            <form class="form" action="{% url 'add_to_bag' product.id %}" method="POST">
                                {% csrf_token %}
                                <div class="form-row">
                                    <div class="col p-0">
                                        <!-- checks if item is not sold; if not then allows to add the product to the shopping bag -->
                                        {% if not product.tag.name == 'sold' %}
                                        <a class="btn" href="{% url 'shop' %}"><span class="icon p-2">
                                                <i class="fas fa-chevron-left" aria-hidden="true"></i>
                                            </span>Keep Shopping</a>
                                        <button class="btn" type="submit">Add to bag<span class="icon p-2">
                                                <i class="fas fa-plus" aria-hidden="true"></i>
                                            </span></button>
                                        {% endif %}
                                    </div>
                                    <!-- by default, redirects to the same item -->
                                    <input type="hidden" name="redirect_url" value="{{ request.path }}">
                                </div>
                            </form>
                            <!-- if item is sold,  contact us button on display and redirects to contact -->
                            {% if product.tag.name == 'sold' %}
                            <a class="btn px-3" href="/#contact-us-home" title="contact us" aria-label="enquire">enquire
                                <span class="icon ps-1">
                                    <i class="fas fa-envelope p-2" aria-hidden="true"></i>
                                </span></a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
